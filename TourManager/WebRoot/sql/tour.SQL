--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 8.0.858
--   Created On : 星期三, 13 五月, 2015 
--   DBMS       : MySql 
--   -------------------------------------------------- 



--  Drop Tables, Stored Procedures and Views 

DROP TABLE IF EXISTS tm_customer_group
;
DROP TABLE IF EXISTS tm_group
;
DROP TABLE IF EXISTS tm_info
;
DROP TABLE IF EXISTS sm_user_autho
;
DROP TABLE IF EXISTS sm_user_role
;
DROP TABLE IF EXISTS sm_autho
;
DROP TABLE IF EXISTS sm_role
;
DROP TABLE IF EXISTS tm_department
;
DROP TABLE IF EXISTS tm_detail
;
DROP TABLE IF EXISTS tm_order
;
DROP TABLE IF EXISTS tm_hotel
;
DROP TABLE IF EXISTS tm_schedule
;
DROP TABLE IF EXISTS tm_employee
;
DROP TABLE IF EXISTS tm_customer
;
DROP TABLE IF EXISTS sm_user
;

--  Create Tables 
CREATE TABLE tm_customer_group
(
	id INTEGER NOT NULL,
	customer_id INTEGER,
	group_id INTEGER,
	enter_time INTEGER,
	oper_id INTEGER,
	is_del CHAR(2),
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_group
(
	id INTEGER NOT NULL,
	group_name VARCHAR(50),
	tour_id INTEGER COMMENT '导游ID 关联employee',
	is_del CHAR(2),
	schedule_id INTEGER,
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	status INTEGER COMMENT '状态 1：未开始 2：正在路上 3：已经结束',
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_info
(
	id INTEGER NOT NULL,
	title VARCHAR(200),
	content VARCHAR(255),
	author VARCHAR(100),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	pic_url VARCHAR(255),
	type INTEGER COMMENT '新闻类型 1：文字新闻 2：图片新闻 3：视频新闻 4：新闻URL',
	is_del CHAR(2),
	PRIMARY KEY (id)
) 
;


CREATE TABLE sm_role_autho
(
	id INTEGER NOT NULL,
	role_id INTEGER,
	autho_id INTEGER,
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	PRIMARY KEY (id)
) 
;


CREATE TABLE sm_user_role
(
	id INTEGER NOT NULL,
	user_id INTEGER,
	role_id INTEGER,
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	PRIMARY KEY (id)
) 
;


CREATE TABLE sm_autho
(
	id INTEGER,
	autho_name VARCHAR(50),
	description VARCHAR(200),
	url VARCHAR(200),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id BIGINT,
	is_del CHAR(2),
	autho_icon VARCHAR(255),
	PRIMARY KEY (id)
) 
;


CREATE TABLE sm_role
(
	id INTEGER NOT NULL,
	role_name VARCHAR(50),
	description VARCHAR(200),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	is_del CHAR(2),
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_department
(
	id INTEGER NOT NULL,
	dept_name VARCHAR(50),
	super_id INTEGER,
	description VARCHAR(200),
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	dept_icon VARCHAR(200),
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_detail
(
	id INTEGER NOT NULL,
	hotel_id INTEGER,
	tour VARCHAR(100) COMMENT '旅游路线',
	walk VARCHAR(50) COMMENT '行',
	eat VARCHAR(50),
	hotel_name VARCHAR(50),
	info VARCHAR(50),
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_order
(
	id INTEGER NOT NULL,
	custom_id INTEGER,
	total_people INTEGER,
	schedule_id INTEGER,
	total_price DOUBLE,
	is_confirm INTEGER COMMENT '是否确认订单 1：是 2：否',
	is_pay INTEGER COMMENT '是否付款 1：是 2：否',
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id BIGINT,
	order_type INTEGER COMMENT '订单类型 1：散客订单 2：包团订单',
	order_desc VARCHAR(255) COMMENT '订单描述',
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_hotel
(
	id INTEGER NOT NULL,
	name VARCHAR(50),
	region_id INTEGER,
	star INTEGER,
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	is_del CHAR(2),
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_schedule
(
	id INTEGER NOT NULL,
	name VARCHAR(100) NOT NULL,
	total_day INTEGER COMMENT '天',
	total_people INTEGER COMMENT '总人数',
	price DOUBLE,
	departure VARCHAR(100),
	destination VARCHAR(100),
	start_time DATE,
	end_time DATE,
	type INTEGER COMMENT '1:短线 2：长线',
	grade INTEGER COMMENT '等级 1:标准团 2：定制团',
	line_code VARCHAR(50) COMMENT '线路分类',
	guider_ids VARCHAR(50) COMMENT '导游id，用逗号分隔,',
	detail_id VARCHAR(50) COMMENT '行程，用逗号隔开',
	create_time DATE,
	create_user_id INTEGER COMMENT '	',
	update_time DATE,
	update_user_id BIGINT,
	is_del CHAR(2),
	schedule_desc VARCHAR(255) COMMENT '日程描述',
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_employee
(
	id INTEGER NOT NULL,
	employee_num VARCHAR(50),
	real_name VARCHAR(50),
	tel VARCHAR(50),
	dept_id INTEGER,
	sex INTEGER COMMENT '0:未知 1：男 2：女',
	is_guider INTEGER COMMENT '是否是导游 1：是 2：否',
	is_del CHAR(2),
	head VARCHAR(255) COMMENT '头像URL',
	PRIMARY KEY (id)
) 
;


CREATE TABLE tm_customer
(
	id INTEGER NOT NULL,
	user_id INTEGER NOT NULL,
	identity_num VARCHAR(50) NOT NULL,
	tel VARCHAR(50),
	type INTEGER COMMENT '1：成人 2：小孩 3:学生',
	classify INTEGER COMMENT '1：散客 2：组团:',
	is_key INTEGER COMMENT '1:是负责人 2：否',
	super_id INTEGER COMMENT '所属负责人',
	sex INTEGER COMMENT '0:未知 1：男 2：女',
	age INTEGER,
	is_del CHAR(2),
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	identity_pic VARCHAR(255) COMMENT '身份证照片',
	PRIMARY KEY (id)
) 
;


CREATE TABLE sm_user
(
	id INTEGER NOT NULL,
	login_name VARCHAR(50) NOT NULL,
	real_name VARCHAR(50) NOT NULL,
	password VARCHAR(50) NOT NULL,
	tel VARCHAR(50),
	sex INTEGER COMMENT '0：未知 1：男 2：女',
	is_admin INTEGER NOT NULL,
	age INTEGER,
	create_time DATE,
	create_user_id INTEGER,
	update_time DATE,
	update_user_id INTEGER,
	status INTEGER COMMENT '状态 1：在线 2：离线',
	is_del CHAR(2),
	PRIMARY KEY (id),
	UNIQUE UQ_sm_user_login_name(login_name)
) 
;
